"use strict";function initPageNDP(){NEWS.pageNDP=NEWS.pageNDP||NEWS.VideoPlayer&&new NEWS.VideoPlayer({el:"#playerframe"})}window.NEWS=window.NEWS||{},NEWS.videoObj=NEWS.videoObj||{},function(){var e=document.getElementsByTagName("script")[0],t=e.parentNode,i=/ded|co/,n="onload",o="onreadystatechange",a="readyState",r=function(r,s){var l=document.createElement("script");l[n]=l[o]=function(){this[a]&&!i.test(this[a])||(l[n]=l[o]=null,s&&s(l),l=null)},l.async=!0,l.src=r,t.insertBefore(l,e)};NEWS.sssl=function(e,t){if("string"==typeof e)return void r(e,t);var i=e.shift();r(i,function(){e.length?NEWS.sssl(e,t):t&&t()})}}(),NEWS.isMobile=function(){var e=!1;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(e=!0),e}(),NEWS.isiPhone=function(){return navigator.userAgent.match(/iPhone/i)}(),NEWS.isiOS=function(){var e=!1;return/iPad|iPhone|iPod/i.test(navigator.userAgent)&&!window.MSStream&&(e=!0),e}(),NEWS.getChromeVersion=function(){var e=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return e?parseInt(e[2],10):!1}(),NEWS.kruxConfig=function(){var e=function(e){var t,i=e;return window.localStorage?window.localStorage[i]||"":navigator.cookieEnabled?(t=document.cookie.match(i+"=([^;]*)"),t&&decodeURI(t[1])||""):""},t=function(e){return $.map(e,function(e,t){return t>40?null:{ksg:e}})},i=e("kxsegs")&&e("kxsegs").split(",")||[],n=e("kxkuid"),o=e("kxuser");return i.length&&i.length>0&&(i=t(i)),o&&""!==o&&(n=o),{kxkuid:n,kxsegs:i}}(),NEWS.videoAnalytics={initVideoAnalyticsBindings:function(){var e=window.$t||function(){var e=function(){var t=arguments,i="getSaves";return t.length>=1&&i!==t[0]&&e.e.push(t),i===t[0]?e.e:""};return e.e=[],e.stub="2.0",e}();e("register",["ndp_playerInit","ndp_playerManualPlay"])},subscribeTsEventsToNdpPlayer:function(e,t){"undefined"!=typeof $t&&$t("track","ndp_playerInit",{playerObj:e,brand:t})},trackVideoManualPlay:function(){"undefined"!=typeof $t&&$t("track","ndp_playerManualPlay")}},NEWS.videoAnalytics.initVideoAnalyticsBindings(),window.$ndp=window.$ndp||{},$ndp.configuration={useCustomControls:!0,freewheel:{siteSectionFallbackID:884078,videoAssetFallbackID:90319997},siteData:{siteSection:"nbcnews_fallbacksitesection",sect:analyticsDataLayer.channelSection,topic:"",feature:"",show:"",storyline:"",kuid:NEWS.kruxConfig.kxkuid,kxsegs:NEWS.kruxConfig.kxsegs},pdk:{skin:{version:"NBCNews 1.0.0",url:"https://media1.s-nbcnews.com/i/videoassets/ndp/skins/nbcnews/1.2/ndp_pdk_skin.json"},layout:{version:"NBC News 1.0.0",string:'<?xml version="1.0"?><layout><controls><card id="tpNormalControls"><region id="tpBottomFloatRegion"><row><control id="tpPlay" skin="PlayButtonSkin"/><group percentWidth="100"><spacer width="20"/><control id="tpCurrentTime"/><spacer width="10"/><control id="tpScrubber" showTooltip="never"/><spacer width="10"/><control id="tpTotalTime"/><control id="tpVolume" expandDirection="up" /><control id="tpCC" deck="forms" card="tpSubtitleStylesCard" icon="IconCC" onMedia="onCCMedia" onPreview="onCCPreview"/><control id="tpFullScreen"/></group></row></region></card><card id="tpAdvertisementControls"><region id="tpBottomRegion"><row><control id="tpPlay" skin="PlayButtonSkin"/><group percentWidth="100"><spacer width="20"/><control id="tpCurrentTime"/><spacer width="10"/><control id="tpScrubber" showTooltip="never"/><spacer width="10"/><control id="tpTotalTime"/><control id="tpVolume" expandDirection="up" /><control id="tpFullScreen"/></group></row></region></card></controls></layout>'}}},"#testAdNetwork"===window.location.hash&&($ndp.configuration.freewheel.siteSectionFallbackID=853833,$ndp.configuration.freewheel.videoAssetFallbackID=56327712,$ndp.configuration.freewheel.nativeProfileId="nbcnews_html5_live"),window.__DY_VIDEO_TEST__&&(window.__DY_VIDEO_TEST__.adRequestTimeout&&($ndp.configuration.freewheel.requestTimeout=parseInt(window.__DY_VIDEO_TEST__.adRequestTimeout)),window.__DY_VIDEO_TEST__.fwPlayerProfile&&($ndp.configuration.freewheel.playerProfile=window.__DY_VIDEO_TEST__.fwPlayerProfile));var VideoControlRack=NEWS.VideoControlRack||{};VideoControlRack.Model=NEWS.VideoControlRack&&NEWS.VideoControlRack.Model||Backbone.Model.extend({defaults:{isAd:!1,isLive:!1,isVideo:!1,isPlaying:!1,inMutedState:!1,inFullscreenState:!1,hideDelay:3e3,lastMouseMove:0,currentTime:0,endTime:0,isDesktop:!1,timeFormat:function(e){var t=Math.abs(Math.floor(e/1e3/60)),i=Math.abs(Math.floor(e/1e3%60));return i=10>i?"0"+i:i,[t,i].join(":")}}}),VideoControlRack.View=NEWS.VideoControlRack&&NEWS.VideoControlRack.View||Backbone.View.extend({el:$("#js-control-rack-placeholder"),template:_.template($("#js-control-rack").html()),events:{"click .js-control-play":"onPlay","click .js-control-pause":"onPause","click .js-control-expand":"onEnterFullscreen","click .js-control-compress":"onExitFullscreen","click .js-control-cc":"onCaptions","click .js-control-volume-on":"onVolumeOn","click .js-control-volume-off":"onVolumeOff","click .scrubber":"onScrub"},initialize:function(e){function t(e,t){t?e.$el.show():e.$el.hide()}var i=this;this.options=e,this.player=this.options.player,this.model=new VideoControlRack.Model,this.model.bind("change",this.render,this),this.model.set({isDesktop:!NEWS.isMobile,useDuringContent:this.options.useDuringContent}),this.player.on($ndp.events.PlaybackEvent.START,_.bind(this.onVideoStart,i)),this.model.get("useDuringContent")&&this.player.on($ndp.events.PlaybackEvent.PROGRESS,_.throttle(_.bind(this.onMediaProgress,i),900)),this.player.on($ndp.events.PlaybackEvent.COMPLETE,_.bind(this.onVideoEnd,i)),this.player.on($ndp.events.AdEvent.START,_.bind(this.onAdStart,i)),this.player.on($ndp.events.AdEvent.PROGRESS,_.bind(this.onAdProgress,i)),this.player.on($ndp.events.AdEvent.COMPLETE,_.bind(this.onAdComplete,i)),this.player.on($ndp.events.AdEvent.ERROR,_.bind(this.onAdError,i)),this.$playerContainer=$(this.player.container()),this.$playerFrame=$(this.player.location()),this.$playerFrame.hover(function(){t(i,!0)},function(){t(i,!1)}),this.$playerContainer.mousemove(function(){i.model.set({lastMouseMove:i.model.get("currentTime")})}),this.$playerContainer.bind("contextmenu",function(){return!1})},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},onPlay:function(e){e.preventDefault(),this.model.set({isPlaying:!0}),this.player.play()},onPause:function(e){e.preventDefault(),this.model.set({isPlaying:!1}),this.player.pause()},onEnterFullscreen:function(){this.player.fullscreen(!0),this.$el.appendTo(this.$playerContainer),this.model.set({inFullscreenState:!0})},onExitFullscreen:function(){this.player.fullscreen(!1),this.model.set({inFullscreenState:!1})},onCaptions:function(){this.player.caption()},onVolumeOn:function(){this.model.set({inMutedState:!0}),this.player.volume(0)},onVolumeOff:function(){this.model.set({inMutedState:!1}),this.player.volume(1)},onVideoStart:function(e){var t=e.getTotalLength();this.model.set({isLive:this.player.mediaAsset().isLiveMedia,isVideo:!0,isPlaying:!0,endTime:t,lastMouseMove:0})},onAdStart:function(e){this.model.set({isAd:!0,isPlaying:!0,lastMouseMove:0,isLive:!1,isVideo:!1})},onMediaProgress:function(e){var t=e.getPlayheadPosition();this.model.set({currentTime:t})},onAdProgress:function(e){var t=e.getPlayheadPosition(),i=e.getTotalLength();this.model.set({currentTime:t}),this.model.set({endTime:i})},onScrub:function(e){var t=Math.floor(100*e.offsetX/this.$el.find(".scrubber").width());this.controlRackScrub(t/100)},controlRackScrub:function(e){this.player.scrub(e);var t=this.model.get("endTime")*e;this.model.set({currentTime:t,lastMouseMove:t})},onVideoEnd:function(){this.model.set({isVideo:!1,isLive:!1,currentTime:0,endTime:0,lastMouseMove:0}),window.$ndp.configuration.useCustomControls=!0},onAdComplete:function(){this.model.set({isAd:!1,currentTime:0,endTime:0,lastMouseMove:0}),window.$ndp.configuration.useCustomControls=this.model.get("useDuringContent")},onAdError:function(){window.$ndp.configuration.useCustomControls=this.model.get("useDuringContent")}}),NEWS.VideoControlRack=VideoControlRack,NEWS.VideoContext="Inline",NEWS.InlineExtend={videoPlayerType:"Inline",events:{},$currentPlaceholder:null,isResizeBound:!1,clickBoundTeases:[],eventTimerInitString:"article-manualplay",timingAdStartString:"videoAdStart",timingVideoStartString:"videoStart",extendedInit:function(){this.initWindowBindings(),this.bindTeaseClicks()},bindTeaseClicks:function(){var e=this;$.each($(".js-video-placeholder"),function(t,i){-1===e.clickBoundTeases.indexOf(this.id)&&(e.clickBoundTeases.push(this.id),$(i).on("click",_.bind(e.onPlayVideoClick,e)),$("#"+this.id.replace("video_mpx_","")).on("click",_.bind(e.onPlayVideoClick,e)))})},onPlayVideoClick:function(e){e.preventDefault(),e.stopPropagation(),this.isResizeBound||(this.isResizeBound=!0,this.initWindowBindings());var t;if($(e.target).parents(".js-video-placeholder").length)t=$(e.target).parents(".js-video-placeholder");else{var i=$(e.target).hasClass("js-play-video")?$(e.target):$(e.target).parents(".js-play-video");t=$("#video_mpx_"+i[0].id)}var n=this.video.videoObj&&this.video.videoObj.mpxId;this.$currentPlaceholder!==t&&(this.$currentPlaceholder&&this.$currentPlaceholder.find(".img-overlay_video").show(),t.find(".img-overlay_video").hide(),this.$currentPlaceholder=t,this.video=_.findWhere(NEWS.videoInstances,{placeHolderID:t[0].id}),""===this.video.videoObj.widget_type?this.videoPlayerType="Video Spread":this.videoPlayerType="Inline",this.movePlayer()),n!==this.video.videoObj.mpxId&&this.$spinner.show(),this.playVideo(this.video)},initWindowBindings:function(){$(window).on("resize",_.bind(this.movePlayer,this)),$(window).on("stickyNav:pageFlowAdj",_.bind(this.movePlayer,this))},movePlayer:function(){if(!this.$currentPlaceholder)return!1;var e={top:this.$currentPlaceholder.offset().top,left:this.$currentPlaceholder.offset().left,width:this.$currentPlaceholder.outerWidth(),height:.5625*this.$currentPlaceholder.outerWidth()};this.$el.css(e)},DYonPlaybackStart:function(){DY&&DY.API&&DY.API("event",{name:"User_watched_a_video",properties:{video:this.video.videoObj.title,watched:window.videoAnalyticsDataLayer.channelSection}})}};var VideoPlayer=NEWS.VideoPlayer||Backbone.View.extend({events:{},isMobile:NEWS.isMobile,isiOS:NEWS.isiOS,chromeVersion:NEWS.getChromeVersion,ads:ads,config:{},ndpPlayer:{},currentVideo:{},videoautoplayed:!1,video:{videoObj:NEWS.videoObj&&NEWS.videoObj.video,nextPlaylist:[],nextVideoIndex:0},initialize:function(){this.config={id:(new Date).getTime(),autoPlay:!1,location:window.document.getElementById("playerframe")},this.ndpPlayer=new NDPPlayer(this.config),this.resetPercentGates(),this.testActive=!_.isUndefined(window.__DY_VIDEO_TEST__),NEWS.isPDK||new NEWS.VideoControlRack.View({player:this.ndpPlayer,useDuringContent:!this.isMobile||!this.isiOS&&this.chromeVersion>=55}),this.$spinner=this.$el.find("#js-player-loading"),this.subscribeToPlaybackEvents(),this.subscribeToTrackingEvents(),NEWS.videoAnalytics.subscribeTsEventsToNdpPlayer(this.ndpPlayer,"nbcnews"),this.extendedInit&&this.extendedInit()},getLastSegment:function(e){var t=e.split("/");return t[t.length-1]},getPlaylist:function(e){if(e.videoObj.associatedPlaylistUrl){var t=this,i=this.getLastSegment(e.videoObj.associatedPlaylistUrl),n="https://data.nbcnews.com/drone/api/query/NBCNews/webapp/1.0/playlistbyid?playlistid="+i,o={url:n,cache:!0,dataType:"jsonp",jsonpCallback:"mpxCb"+i,success:function(e){t.currentVideo.nextPlaylist=$.grep(e.results,function(e){return t.currentVideo.videoObj.mpxId!==e.video.mpxId})}};0===e.nextPlaylist.length&&$.ajax(o)}},playVideo:function(e){e.videoObj.isContinuousPlay||e.videoObj.autoPlay||NEWS.videoAnalytics.trackVideoManualPlay(),main.eventTimerInit(this.eventTimerInitString),this.ndpPlayer.mediaAsset(new $ndp.MPXMediaAsset(e.videoObj)),this.updateAdsConfig(),e.videoObj.videoPlayerType=this.videoPlayerType,this.currentVideo=e,"Non Broadcast Live Video"===e.videoObj.videoType&&(e.videoObj.isLive=!0),this.setCaptionSize(this.currentVideo.videoObj),this.ndpPlayer.play()},setCaptionSize:function(e){var t=["OnceURL","Limelight MP4"],i=_.some(e.videoAssets,function(e){return _.contains(t,e.assetType)}),n=i?.4:1;window.$pdk&&window.$pdk.controller.setSubtitleStyle({globalDataType:"com.theplatform.pdk.data::SubtitleStyle",fontSize:n,textAlign:"left"})},onAdStart:function(){this.$spinner.hide()},onPlaybackStart:function(){this.$spinner.hide(),this.getPlaylist(this.currentVideo)},onPlaybackComplete:function(){var e=this;setTimeout(function(){e.currentVideo.nextPlaylist&&e.currentVideo.nextPlaylist.length&&(e.currentVideo.videoObj=e.currentVideo.nextPlaylist[e.currentVideo.nextVideoIndex].video,e.currentVideo.videoObj.isContinuousPlay=!0,e.$spinner.show(),e.playVideo(e.currentVideo),e.currentVideo.nextVideoIndex===e.currentVideo.nextPlaylist.length-1?e.currentVideo.nextVideoIndex=0:e.currentVideo.nextVideoIndex++)},50)},updateAdsConfig:function(){$ndp.configuration.siteData.siteSection=ads.getFreewheelValue()||"nbcnews_fallbacksitesection",ads.videoData&&($ndp.configuration.siteData.sect=ads.videoData.section||"",$ndp.configuration.siteData.topic=ads.videoData.topic||"",$ndp.configuration.siteData.show=ads.videoData.show||"",$ndp.configuration.siteData.storyline=ads.videoData.storyline||"",$ndp.configuration.siteData.feature=ads.videoData.feature||"")},resetPercentGates:function(){this.videoGates=[{percent:25,tracked:!1},{percent:50,tracked:!1},{percent:75,tracked:!1}]},sendDYStart:function(){this.testEventSent||(this.sendDYEvent("VideoStart"),this.testEventSent=!0)},sendDYEvent:function(e,t){var i=window.DY;i&&_.isFunction(i.API)&&i.API("event",{name:e,properties:t||{}})},trackOnAdStart:function(){main.eventTimer(this.timingAdStartString),this.sendDYStart(),this.sendDYEvent("VideoAdStart"),_satellite.setVar("DTMVideoObject",this.currentVideo.videoObj),_satellite.track("videoAdStart")},trackOnAdPause:function(){_satellite.track("videoAdPause")},trackOnAdComplete:function(){_satellite.setVar("DTMVideoObject",this.currentVideo.videoObj),_satellite.track("videoAdComplete")},trackOnAdError:function(e){e.payload&&e.payload.error&&_.intersection(e.payload.error,$ndp.events.AdEvent.ADSKIP).length>=1&&this.sendDYEvent("VideoAdTimeout")},trackOnPlaybackStart:function(){main.eventTimer(this.timingVideoStartString),this.sendDYStart(),this.resetPercentGates(),_satellite.setVar("DTMVideoObject",this.currentVideo.videoObj),_satellite.track("videoStart")},trackOnPlaybackComplete:function(){_satellite.setVar("DTMVideoObject",this.currentVideo.videoObj),_satellite.track("videoComplete")},trackOnPlaybackProgress:function(e){var t=this;if(e.payload.totalLength>0&&!t.currentVideo.videoObj.isLive){var i=e.payload.playheadPosition/e.payload.totalLength;$.each(t.videoGates,function(e,n){100*i>=n.percent&&!n.tracked&&(_satellite.track("video"+n.percent.toString()),t.logger&&t.logger("###:",["videoProgress-"+n.percent.toString()]),n.tracked=!0)})}},trackOnPlaybackSeek:function(){this.currentVideo.videoObj.isLive||_satellite.track("videoScrub")},subscribeToPlaybackEvents:function(){this.ndpPlayer.on($ndp.events.AdEvent.START,_.bind(this.onAdStart,this)),this.ndpPlayer.on($ndp.events.PlaybackEvent.START,_.bind(this.onPlaybackStart,this)),this.ndpPlayer.on($ndp.events.PlaybackEvent.COMPLETE,_.bind(this.onPlaybackComplete,this))},subscribeToTrackingEvents:function(){this.ndpPlayer.on($ndp.events.PlaybackEvent.PROGRESS,_.bind(this.trackOnPlaybackProgress,this)),this.ndpPlayer.on($ndp.events.PlaybackEvent.SEEK,_.bind(this.trackOnPlaybackSeek,this)),this.ndpPlayer.on($ndp.events.PlaybackEvent.COMPLETE,_.bind(this.trackOnPlaybackComplete,this)),this.ndpPlayer.on($ndp.events.PlaybackEvent.START,_.bind(this.trackOnPlaybackStart,this)),this.ndpPlayer.on($ndp.events.AdEvent.START,_.bind(this.trackOnAdStart,this)),this.ndpPlayer.on($ndp.events.AdEvent.COMPLETE,_.bind(this.trackOnAdComplete,this)),this.ndpPlayer.on($ndp.events.AdEvent.PAUSE,_.bind(this.trackOnAdPause,this)),this.ndpPlayer.on($ndp.events.AdEvent.ERROR,_.bind(this.trackOnAdError,this))}});switch(NEWS.VideoContext){case"Offsite":_.extend(VideoPlayer.prototype,NEWS.OffsiteExtend);break;case"Showfront":break;case"Inline":_.extend(VideoPlayer.prototype,NEWS.InlineExtend)}NEWS.VideoPlayer=VideoPlayer;var NDP_VERSION="1.3.4",NDP_BASE_BUILD="ndp",NDP_HLS_BUILD="ndp-hls",PDK_VERSION="1.1.7",PDK_BUILD="ndpplayer-legacy";NEWS.isPDK=!1,NEWS.NDP_BASE_URL="https://media1.s-nbcnews.com/i/videoassets/ndp/{version}/{build}.js",NEWS.selectNDPScript=function(){var e={version:"",build:""},t=window.MediaSource||window.WebKitMediaSource;return t||NEWS.isMobile?(e.version=NDP_VERSION,document.createElement("video").canPlayType("application/x-mpegURL").length>0?e.build=NDP_BASE_BUILD:e.build=NDP_HLS_BUILD):(NEWS.isPDK=!0,e.version=PDK_VERSION,e.build=PDK_BUILD),e},NEWS.loadNDPScripts=function(e){var t=e||initPageNDP;if(window.$ndp&&window.$ndp.NDPPlayer)return t(),!1;var i=NEWS.selectNDPScript(),n=NEWS.NDP_BASE_URL;return n=n.replace("{version}",i.version),n=n.replace("{build}",i.build),window.__DY_VIDEO_TEST__&&window.__DY_VIDEO_TEST__.videoPlayerUrl&&(n=window.__DY_VIDEO_TEST__.videoPlayerUrl,NEWS.useNdpBeta=!0),NEWS.sssl(n,t),!0};var articleApp=articleApp||{},enablePushState=!0,pushState=!!(enablePushState&&window.history&&window.history.pushState);if(pushState){var Router=Backbone.Router.extend({});articleApp.router=new Router,Backbone.history.start({pushState:pushState})}articleApp.logger=function(e,t,i){var n="";i&&(n=(new Date).getMinutes()+"m "+(new Date).getSeconds()+"s");var o=window.console&&!document.location.hostname.match(/www.nbcnews.com|local.nbcnews.com/)&&/Chrome|Firefox/i.test(navigator.userAgent);o&&console.log(e,t,n)},articleApp.getUrlPath=function(e){return e.replace("http://www.nbcnews.com","")},articleApp.initScrollUp=function(){$(".article-body").waypoint(function(e){if("up"===e){var t=$(this).closest(".article_entry").attr("id"),i=$(this).closest(".article_entry").data("url"),n=articleApp.getUrlPath(i);if(n!==document.location.pathname){var o=$(this).closest(".article_entry").find("h1").text();document.title=o+" - NBC News",articleApp.logger("### scroll-up navigate",[t,articleApp.trackingHistory[t]]),pushState&&articleApp.router.navigate(n,{replace:!0}),$("body").trigger("scrolled-up-to-previous",articleApp.trackingHistory[t])}}},{offset:"bottom-in-view",triggerOnce:!1})},articleApp.ajaxHistory=[],articleApp.articles={},articleApp.analyticsDataLayerHistory=[],articleApp.trackingHistory={},articleApp.trackingHistory[window.analyticsDataLayer.externalId]=window.analyticsDataLayer,articleApp.idx=0,articleApp.articleViewBindings=function(e){e&&(setTimeout(function(){"undefined"!=typeof instgrm&&instgrm.Embeds.process(),"undefined"!=typeof FB&&FB&&FB.XFBML&&FB.XFBML.parse&&FB.XFBML.parse()},300),$(".js-toggle",".article_entry:last").each(function(e,t){$(t).on("click",function(){var e=$(this).data("togglecontrols");$(e.selector).toggle()})})),articleApp.shareInit(),articleApp.lightBoxInit()},articleApp.updateArticleContext=function(){$("h1").each(function(e,t){if(main.isElementInViewport(t)){var i=$(t).closest(".article_entry").attr("id"),n=$(t).closest(".article_entry").data("url"),o=$(t).text();articleApp.articles[i]||(articleApp.articles[i]={externalId:i,canonical_url:n,headline:o},0===e&&(articleApp.articles[i].wasTracked=!0)),articleApp.articleContext=articleApp.articles[i]}})},articleApp.updateArticle=function(e){var t=0,i=$.map(articleApp.nextArticles,function(t,i){return t.externalId===e?i:void 0});i.length&&(t=i[0]+1);var n=articleApp.nextArticles[t];n&&$("#next-story_"+e).html(n.headline).attr("href",n.canonical_url)},articleApp.insertNextArticle=function(e){var t=$(".article_entry:last",e);$(t).insertAfter(".article_entry:last"),main.viewBindings(),"undefined"!=typeof _site&&_site.liveblogBindings(),ads&&ads.articleController&&ads.articleController.getNewAdsForArticleEntry&&ads.articleController.getNewAdsForArticleEntry(t),$("body").trigger("article-ajax-complete",[articleApp.lastAjaxArticle]),articleApp.idx++,articleApp.initVideoBindings()},articleApp.initVideoBindings=function(){NEWS&&NEWS.pageNDP?NEWS.pageNDP.bindTeaseClicks():NEWS&&NEWS.articleHasVideo&&NEWS.loadNDPScripts()},articleApp.doScroll=function(){articleApp.updateArticleContext();var e=$("#"+articleApp.articleContext.externalId);if(articleApp.hasLoadedAjaxArticle){var t=150;e.offset().top<$(window).scrollTop()+$(window).height()+-t&&$("body").trigger("article-inview-top",[articleApp.articleContext])}if(e.html()){var i=$(window).scrollTop()+articleApp.initialWindowHeight;if(i>=$(document).height()-.3*e.height()){var n=articleApp.sectionTopic+"/ajax-article-n";articleApp.idx<articleApp.nextArticles.length&&-1===articleApp.ajaxHistory.indexOf(articleApp.nextArticles[articleApp.idx])&&(articleApp.ajaxHistory.push(articleApp.nextArticles[articleApp.idx]),$.get(n+articleApp.nextArticles[articleApp.idx].externalId,articleApp.insertNextArticle))}}},articleApp.bindPageEvents=function(){$(document).on("article-ajax-complete",function(e,t){articleApp.logger("###: "+e.type,[t]),articleApp.updateArticle(t.externalId)}),$(document).on("scrolled-up-to-previous",function(e,t){window.analyticsDataLayer=t,_satellite.track("scrolled_up_to_previous"),articleApp.logger("###: "+e.type,[t])}),$(document).on("article-inview-top",function(e,t){var i=articleApp.getUrlPath(t.canonical_url);if(i!==document.location.pathname&&(pushState&&articleApp.router.navigate(i,{replace:!0}),document.title=t.headline+" - NBC News",articleApp.logger("### navigate: "+e.type,[t,document.location.pathname]),ads&&ads.articleController&&ads.articleController.articleInview)){var n=$("#"+articleApp.articleContext.externalId);ads.articleController.articleInview(n)}t.wasTracked||$("body").trigger("track-article-view",[t]),articleApp.initScrollUp()}),$(document).on("track-article-view",function(e,t){if(t.externalId!==window.analyticsDataLayer.externalId){articleApp.logger("### externalId Mismatch: "+e.type,[t.externalId,window.analyticsDataLayer.externalId]);var i=$.grep(articleApp.analyticsDataLayerHistory,function(e,i){return e.externalId===t.externalId})[0];i&&(window.analyticsDataLayer=i)}articleApp.logger("###: "+e.type,[window.analyticsDataLayer.externalId,window.analyticsDataLayer]),_satellite.track("articleView"),"undefined"!=typeof DY&&DY&&DY.API&&(DY.API("track_pageview",{url:""}),DY.AdDetection.ne()),articleApp.trackingHistory[window.analyticsDataLayer.externalId]=window.analyticsDataLayer,t.wasTracked=!0}),$(document).on("video-play-clicked",function(e,t){articleApp.logger("###: "+e.type,[t],!0)}),$(document).on("rAF-scroll",function(){articleApp.doScroll()}),$(window).on("touchmove",function(){articleApp.doScroll()}),NEWS&&NEWS.articleHasVideo&&NEWS.loadNDPScripts()},$(function(){articleApp.bindPageEvents(),articleApp.initialWindowHeight=$(window).height()}),articleApp.stickyShare=function(){var e=parseFloat($(".js-site-header").css("margin-bottom")),t=$(window).scrollTop()+e;main.isNavFixed&&(t=$(window).scrollTop()+(main.headerHeight+e)),$(".article_entry").each(function(i,n){var o=$(n).find(".js-share"),a=$(n).find(".js-bottom-limit"),r=$(n).find(".js-article-body"),s=$(n).find(".js-sticky"),l=0,c=0;o.length&&(l=o.offset().top),a.length&&(c=a.offset().top);var d=s.outerHeight(!0),p=a.outerHeight(!0),u=r.outerHeight(!0),h=c-d;if(t>l){if(main.isNavFixed){l-=main.headerHeight;var v=main.headerHeight+e;s.css("top",v)}else s.css("top",e);s.addClass("is-sticky"),s.removeClass("is-stuck"),s.css("bottom","auto")}else s.removeClass("is-sticky"),s.removeClass("is-stuck"),s.css("bottom","auto");if(t>h){s.removeClass("is-sticky"),s.addClass("is-stuck");var g=p;$(n).find(".is-media-entry").each(function(){g=-Math.abs(u-p)}),s.css({bottom:g,top:"auto"})}})},articleApp.printArticle=null,articleApp.print=function(e){var t=$(e).closest("article").get(0);if(t){articleApp.printArticle=t;var i={id:"article-printx",src:"/pages/print","class":"article-print-dialog"};$("#"+i.id).remove();var n=$("<iframe />");n.attr("id",i.id).attr("name",i.id).attr("src",i.src).attr("class",i["class"]),$("body").append(n),$("#"+i.id).load(function(){var e=window.frames[i.id];e.focus(),void 0!==e.onafterprint?(e.onafterprint=function(){$("#"+i.id).remove()},e.print()):(e.print(),setTimeout(function(){$("#"+i.id).remove()},1e3))})}},articleApp.shareInit=function(){$(".js-sharearticle").off("click").on("click",function(e){e.preventDefault(),$(this).hasClass("print")?articleApp.print(this):main.openShareDialog(this.href,{contextType:"article"})})},$(function(){$(document).on("rAF-scroll",function(){articleApp.stickyShare()})}),articleApp.buildLightBox=function(e,t){$('<div class="lightbox">').appendTo("body").html('<div class="lightbox_container"><img class="img-responsive" src="'+e+'" alt="" /> '+t+'<button class="btn btn_primary btn_lg" aria-label="close"><i aria-hidden="true" class="fa fa-times"></i></i></button></div>'),$("body").on("click",".lightbox",function(){$(".lightbox").remove()})},articleApp.lightBoxInit=function(){$(".js-lightbox").click(function(e){if(viewport().width>768){e.preventDefault();var t=$(this).attr("href"),i=$(this).next(".js-caption_wrapper").html();articleApp.buildLightBox(t,i)}})},$(document).ready(function(){articleApp.lightBoxInit()});var _site=_site||{};_site.liveBlogUtils={},_site.liveBlogUtils.pluralize=function(e,t){return e&&e>1&&(t+="s"),e+t},_site.liveBlogUtils.toQueryString=function(e){var t=_.reduce(e,function(e,t,i){return e.push(i+"="+encodeURIComponent(t)),e},[]).join("&");return t.length>0&&(t="?"+t),t},_site.liveBlogScrollBindings=function(){var e=parseFloat($(".js-site-header").css("margin-bottom")),t=$(window).scrollTop()+e;main.isNavFixed&&(t=$(window).scrollTop()+(main.headerHeight+e)),$(".liveblog").each(function(i,n){var o=$(n),a=o.find(".liveblog_bt-new-post"),r=o.offset().top,s=r+o.height();t>r&&s>t?(main.isNavFixed?a.css("top",main.headerHeight+e):a.css("top",e),a.addClass("is-sticky"),a.removeClass("is-stuck")):a.hasClass("is-sticky")&&a.removeClass("is-sticky")})},_site.liveBlogInit=function(e){function t(){var e=n,t={};return"undefined"!=typeof o&&o&&(t.embedVideos=!0),"undefined"!=typeof a&&a&&(t.count=a),t.rendering="liveblog",e+=_site.liveBlogUtils.toQueryString(t)}function i(){function e(e){var t=$(e);p=t.filter(".liveblog_post"),p.each(function(e,t){var i=$(t),n=new Date(i.data("liveblog-post-updated")).getTime(),o=new Date(i.data("liveblog-post-created")).getTime(),a=i.data("liveblog-post-id"),r=u.filter('[data-liveblog-post-id="'+a+'"]');n>h&&h>o?(r.replaceWith(i),i.find("time.js-timeago").timeago(),main.viewBindings(),h=n):o>v&&$(".liveblog_bt-new-post").show().text(_site.liveBlogUtils.pluralize(e+1," New Post"))})}function n(){r=180}"undefined"!=typeof articleApp&&(articleApp.nextArticles=[]),u=l.find(".liveblog_post"),$.ajax({url:"/news/api/channels/"+t(),success:e,error:n}),setTimeout(i,1e3*r)}if("string"==typeof e.channel){var n=e.channel,o=e.embedVideos,a=e.howManyPostsToLoad,r=15,s='.liveblog[data-liveblog-channel="'+n+'"]',l=$(s),c=l.find(".liveblog_bt-new-post"),d=l.find(".liveblog_bt-show-more"),p="",u=l.find(".liveblog_post"),h=new Date(u.first().data("liveblog-post-updated")).getTime(),v=new Date(u.first().data("liveblog-post-created")).getTime(),g=(new Date).getTime(),f=!0;c.on("click",function(e){e.preventDefault(),_satellite.track("liveblog_loadnew_click"),u=$(s).find(".liveblog_post"),$("html,body").animate({scrollTop:l.offset().top-200},350,function(){$(p.get().reverse()).each(function(e,t){var i=$(t),n=new Date(i.data("liveblog-post-updated")).getTime(),o=new Date(i.data("liveblog-post-created")).getTime();o>v&&(i.insertBefore(l.find(".liveblog_post:first")),i.find("time.js-timeago").timeago(),v=n)}),main.viewBindings(),"undefined"!=typeof articleApp&&o!==!0&&(articleApp.initVideoBindings(),articleApp.articleViewBindings(!0)),c.slideUp()})}),d.on("click",function(e){function i(e){var t=$(e),i=t.filter(".liveblog_bt-show-more");p=t.filter(".liveblog_post"),p.insertBefore(d),p.find("time.js-timeago").timeago(),main.viewBindings(),"undefined"!=typeof articleApp&&o!==!0&&(articleApp.articleViewBindings(),setTimeout(function(){articleApp.initVideoBindings()},1200)),i.length>0?d.html(i.html()):d.hide()}function n(){}function a(){d.removeClass("is-active")}e.preventDefault(),d.addClass("is-active");var r=u.last().data("liveblog-post-created");$.ajax({url:"/news/api/channels/"+t()+"&endtime="+r,success:i,error:n,complete:a})}),g-h>0&&(g-h)/864e5>.5&&(f=!1),f===!0&&setTimeout(i,1e3*r),e.hasLoaded=!0}},_site.liveblogBindings=function(){window._liveblogs&&$.each(window._liveblogs,function(e,t){t.hasLoaded===!1&&_site.liveBlogInit(t)})},$(function(){_site.liveblogBindings(),$(document).on("rAF-scroll",function(){_site.liveBlogScrollBindings()});var e={suffixAgo:"ago",suffixFromNow:"from now",inPast:"any moment now",seconds:"%d sec",minute:"1 min",minutes:"%d mins",hour:"1 hr",hours:"%d hrs",day:"1 day",days:"%d days",month:"1 month",months:"%d months",year:"1 year",years:"%d years",wordSeparator:" "};jQuery.timeago.settings.strings=e,$("time.js-timeago").timeago()});